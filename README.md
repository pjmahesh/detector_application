# Detector Application

# Connecting Pi to new Wi-Fi : wpa_supplicant.conf
<pre>

> Open wpa_supplicant.conf in notepad. 
> Replace wifi credentials.
> Plug Pi SD card to PC.
> Copy wpa_supplicant.conf to boot drive.
> Insert SD and start Pi.
> Pi hostname is “pi4”   
  SSH: <b>ssh pi@pi4</b> or <b>ssh pi@<span></span>pi4.local</b>  
  SFTP: <b>sftp pi@pi4</b> or <b>sftp pi@<span></span>pi4.local</b> 
  
</pre>

# Level Detection Script / Main Script : capp.sh
<pre>

<b>Prototype:
./capp.sh Camera01 Camera02 Camera03 Camera04 time </b>

> Arg1 : Camera UART(USB to TTL) hardware device name. Here ‘Camera01’
> Arg2 : Camera UART(USB to TTL) hardware device name. Here ‘Camera02’
> Arg3 : Camera UART(USB to TTL) hardware device name. Here ‘Camera03’
> Arg4 : Camera UART(USB to TTL) hardware device name. Here ‘Camera04’
> Arg5 : Last digit of minute of current timestamp. 
         Cronjob for every 10 minutes will forever execute the script every 10 minutes.

<b>Output : Eg.,</b>
Level not detected in Camera01.jpg
Level detected in Camera02.jpg
Level: 19.022225 cm - 19.523577 cm
Passed to node! Baud rate: 38400

<b>Cron job :</b>  
$ crontab -e  
Add the line:   
<b>"*/10 * * * * /home/pi/detector_application/capp.sh Camera01 Camera02 Camera03 Camera04 0 >> /home/pi/detector_application/cronLog.txt 2>&1"</b>   

<b>Note:</b>   
> Arg1, Arg2, Arg3, Arg4  are hardware device names. Not image names with .jpg extension. 
> Camera01 will (only) take file conf01.csv for image detection. Likewise the other devices.
> conf0x.jpg is generated by running makeConf.py giving cutoff0y.csv (x and y need not be same)

</pre>

# Training new images : makeConf.py
 
<pre>

<b>Prototype:  
python3 makeConf.py example0x.jpg cutoffxx.csv</b> 
Output: Will generate conf0x.csv. The name is dependent only on the last digit of camera image names. 

<b>Note:</b>  
> Camera01 will take conf01.csv only.   
> For Camera02,  If training conditions/image is same, copy conf01.csv as conf02.csv  

</pre>

# Analysis script (will be called from capp.sh): dataprep.py
<pre>

<b>Prototype: 
python3 dataprep.py Camera01.jpg Camera02.jpg Camera03.jpg Camera04.jpg WSN-tty </b>   
> Arg1 (Image name): 
Camera01.jpg - Created by app.c (a.out) program taking image from device Camera01
Likewise other image arguments.
> Arg5 (WSN port): 
Port of WSN-Node attached. capp.sh will detect the port. 
<b>If running this script manually,</b> the WSN-Node port has to be manually found out and given as arg3. 
   Eg., ttyUSB2
   (or) Port name will be ttyWSN if udev rule is added and the WSN uart converter is preprogrammed. 

<b>Note:</b>
> Upto 9 cameras are supported now. 
> <b>If running this script manually,</b> Image names can be given without any name constraints. 
   Eg., python3 dataprep.py image.jpg photo.jpg ttyUSB2
   
</pre>

